= Основы толпы =

"""Общее представление о симуляции толпы в Houdini."""

== Обзор ==

:vimeo:Crowd intro
    #id: 116878790
    #keywords: generate crowd, Simulate Tool, crowd states, crowd behaviors, crowd triggers, agents, crowdsource, crowd transition node, crowdsolver, crowd system, crowd avoidance, crowd terrain, crowd bake cycle, crowd_sim, Crowd Paint Density

*Агенты (Agents)* это риги персонажей с геометрией кожи и анимацией, каждый из которых связан с частицей, которая представлена точкой в DOP симуляции. У Агентов есть текущее *состояние (state)*. А состояние соответствует *клипу (clip)* который анимирует агента, пока она находится в текущем состоянии. Состояние так же содержит *узлы поведения (behavior nodes)* которые изменяют агента такие, как силы частиц (particle forces) в DOP, которые перемещают точку агента. На каждом шаге симулции Houdini оценивает *триггеры* для каждого агента. Если триггер соответствует агенту, он активирует ноду *перехода (transition)* которая меняет текущее состояние агента на новое.

Например, что бы создать толпу, у вас должны быть несколько агентов в состоянии `ходьбы (walk)` и несколько в состоянии `покоя (idle)`. У состояния идущий будут внутрнние узлы поведения для перемещения точки агента в этом состоянии. Триггер проверяет, был ли каждый агент в текущем состоянии дольше определенного периода. Триггер должен привести к двум нодам перехода (ходьба -> покой и покой -> ходьба) что-бы поменять состояние каждого соответствующего агента.

Толпы создаются из точек в [geometry network|setup#geo], где вы можете использовать всю мощь нод геометрии Houdini и создать позиции агентов из существующих моделей, таких как ландшафт (terrain). Фактически симуляция толпы выполняется в [simulation network|setup#dops], где агенты могут [взаимодействовать|interaction] с другими динамическими элементами.

Смотрите [как настроить симуляцию толпы|setup] для получения информации о том, как использовать инструменты полки для создания простой симуляции толпы.

== Концепции ==

[Исходные точки|setup]:
    "источник" для симуляции толпы - это точки в SOP сети, представляющие начальное положение агентов.
    
    Однако, если вы не имеете исходных точек, [Crowd Source surface нода|Node:sop/crowdsource] произвольно распределит определенное количество точек по заданной области автоматически.

[Агенты|agents]:
    [Агенты|/crowds/agents] это "актеры" симуляции толпы , например отдельные люди в сцене. Агент выглядет как сабнет или ассет, содержащий риг и геометрию агента. Перед тем как использовать части анимации персонажа, вы должны [сохранить анимацию|clips] на диск.

    _Исходная точка_, из которой создан агент, определяет его начальное положение.[Crowd Source нода|Node:] преобразует точки в специальные  _примитивы агента (agent primitives)_, с примитивными атрибутами содержащими информацию, используемую солвер толпы. Запакованная геометрия агента загружается как [запакованный примитив|/model/packed], поэтому отображение и рендер большого количества агентов по-прежнему быстрые.

    Смотрите [setup|setup] как создать начальную симуляцию толпы.

[Состояния|states]:
    #contentfrom: states#oview

[Клипы|clips]:
    #contentfrom: clips#oview

[Весы|weights]:
    #contentfrom: weights#oview

[Триггеры и переходы|triggers]:
    #contentfrom: triggers#oview

[Препятствия|obstacles]:
    #contentfrom: obstacles#oview

[Ландшафт|terrain]:
    В настоящее время Houdini поддерживает один объект ландшафта (статический объект RBD). Агенты будут повторять рельеф ландшафта, с дополнитльной адаптацией к ступней (IK foot adaptation).

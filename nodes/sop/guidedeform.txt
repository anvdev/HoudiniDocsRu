#type:     node
#context:  sop
#internal: guidedeform
#icon:     FUR/animate

= Guide Deform =

"""Деформирует геометрию в соответствии с анимированной поверхностью кожи и, при необходимости, направляющие кривые."""

Эта нода деформирует геометрию в соответствии с другой деформированной геометрией. Обычно используется для деформации волос в соответствии с анимированной сеткой.

Также может деформировать входную геометрию с помощью направляющих кривых.

Входная геометрия может являться кривыми волос, например густая прическа персонажа, генерируемая в состоянии покоя.

Оператор также может деформировать произвольную геометрию.

@parameters

Mode:
    #id: mode

    Deform only by Skin:
	Деформирует входную геометрию как разность между состоянием покоя и анимированной геометрией кожи.

    Guide Capture and Deform:
	Находит ближайшие направляющие в геометрии покоя для каждой точки геометрии первого входа и присваивает им веса в зависимости от их расстояния до направляющей.

	Затем каждая точка деформируется как разность между состоянием покоя и анимированными направляющими.

    Guide Capture:
	Находит ближайшие направляющие в геометрии покоя для каждой точки геометрии первого входа и присваивает им веса в зависимости от их расстояния до направляющей. 

	Результат выводится в атрибуты `guides` и `weights`. Они могут использоваться для деформации геометрии с помощью другого Guide Deform SOP при выбранном режиме __Guide Deform__.

    Guide Deform:
	Использует атрибуты `guides` и `weights`, полученные другим Guide Deform SOP, чтобы деформировать каждую точку первого входа как разность между сотоянием покоя и анимированными направляющими.

== Capture ==

Guide Coverage:
    #id: guidecoverage

    Параметр устанавливает количество направляющих, которые окажут влияние на захват и деформацию каждой точки.

Use Guide Radius Attribute:
    #id: useguideradiusattrib

    Использует указанный атрибут направляющих для определения их радиусов воздействия.

Guide Radius Attribute:
    #id: guideradiusattrib

    Имя атрибута, определяющего радиус воздействия направляющей.

Compute Radius From Guide Coverage:
    #id: computeradius

    Вычисляет радиус автоматически, таким образом, что каждая точка найдет примерное количество направляющих, заданных __Guide Coverage__.

    Это облегчает деформацию с помощью направляющих, которые имеют разную плотность по всей геометрии кожи. Например, при необходимости использовать большее количество направляющих на лице персонажа.

Radius:
    #id: radius

    Когда __Compute Radius From Guide Coverage__ отключен, данный параметр устанавливает абсолютный радиус воздействия направляющих.

Limit Segments Per Guide:
    #id: limitguidesegs

    Ограничивает количество захватываемых сегментов для каждой направляющей. Это помогает управлять объемом памяти (или дискового пространства), который занимает информация о весах.

Segments Per Guide:
    #id: maxguidesegs

    Максимальное количество сегментов, которые могут быть исползованы для захвата каждой точки с первого входа.

Expand Radius for Uncaptured Points:
    #id: expandradius

    Расширяет радиус для точек, которые не обеспечены достаточным количеством направляющих, указанным в параметре __Guide Coverage__.

    Это позволяет указать небольшое количество направляющих (или небольшой радиус) в целом, что необходимо для сохранения мелко детализированного перемещения направляющих, и при этом решить проблему нехватки требуемого количества точек для захвата движения.

Expansion Iterations:
    #id: expansioniters

    Максимальное количество итераций расширения радиуса. Если каждая точка попадает под влияние необходимого количества кривых, указанного в __Guide Coverage__, то цикл может остановиться раньше. 

Expansion Factor:
    #id: expansionfactor

    Коэффициент, на который радиус умножается в каждой итерации расширения.

== Deform ==

Geometry to Deform:
    #id: inputtype

    Hair Curves:
	Деформация геометрии кривых со входа. Основное отличие этого параметра заключается в том, что первая точка каждого примитива должна сидеть на геометрии кожи в состоянии покоя, что обеспечит корректное положение на анимированной поверхности кожи.

    Arbitrary Geometry:
	Деформация любой геометрии. Обратите внимание, что это работает и для кривых, но не должно для них использоваться, поскольку не обеспечивает выполнение условий на анимированной поверхности, упомянутых выше.

Rigidly Transform Pieces:
    #id: rigidtransform

    Вычисляет жесткое преобразование каждой части, которое соответствует мягкой деформации направляющей как можно ближе.

    Части определяются по принципу связанности (connectivity) или с помощью существующего атрибута, когда активен параметр __Use Piece Attribute__.

Use Piece Attribute:
    #id: usepieceattrib

    Для определения частей используется атрибут, вместо определения связанности.

Piece Attribute:
    #id: pieceattrib

    Атрибут для определения частей. Все точки с одинаковым значением считаются единой частью.

Attributes to Transform:
    #id: xformattribs

    Атрибуты геометрии с первого входа, подлежащей деформации.
